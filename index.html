<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
  <link rel="stylesheet" href="style.css">
  <script>
    // Telegram Web App API
    document.addEventListener("DOMContentLoaded", () => {
      if (window.Telegram?.WebApp) {
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω Telegram
      }
    });
  </script>
</head>
<body>
  <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö–µ–¥–µ—Ä —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
  <header>
    <nav>
      <a href="#" data-page="games">–ú–∏–Ω–∏-–∏–≥—Ä—ã</a>
      <a href="#" data-page="challenge">–ß–µ–ª–µ–Ω–¥–∂ –î–Ω—è</a>
      <a href="#" data-page="word">–°–ª–æ–≤–æ –î–Ω—è</a>
      <a href="#" data-page="fact">–§–∞–∫—Ç –î–Ω—è</a>
    </nav>
  </header>

  <hr>

  <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
  <div id="greeting">
    <h2>üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π! üòâ</h2>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
  <div id="content"></div>

  <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä -->
  <script src="gamesGC.js"></script>

  <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const contentDiv = document.getElementById('content');
      const links = document.querySelectorAll('header nav a');

      links.forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const page = link.getAttribute('data-page');

          if(page === "games") {
            if(typeof showGamesList === "function") showGamesList();
          } else {
            loadPage(page);
          }
        });
      });

      async function loadPage(page) {
        let jsonFile = '';

        switch(page) {
          case 'challenge': jsonFile = 'data/challenge.json'; break;
          case 'word': jsonFile = 'data/words.json'; break;
          case 'fact': jsonFile = 'data/facts.json'; break;
          default: return;
        }

        try {
          const res = await fetch(jsonFile);
          const data = await res.json();
          window[page + 'Data'] = data;
          showRandomItem(page);
        } catch(err) {
          console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", err);
          contentDiv.innerHTML = "<p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.</p>";
        }
      }

      function getRandomItem(array) {
        return array[Math.floor(Math.random() * array.length)];
      }

      function showRandomItem(page) {
        const data = window[page + 'Data'];
        if(!data) return;

        const item = getRandomItem(data);
        let html = `<div class="card">`;

        if(page === 'challenge') {
          html += `<h2>${item.title}</h2><p>${item.description}</p>`;
        } else if(page === 'word') {
          html += `<h2>${item.word}</h2>
                   <p>–ó–Ω–∞—á–µ–Ω–∏–µ: ${item.meaning}</p>
                   <p>–ü—Ä–∏–º–µ—Ä: ${item.example}</p>
                   ${item.fun_fact ? `<p>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: ${item.fun_fact}</p>` : ''}`;
        } else if(page === 'fact') {
          html += `<h2>${item.title}</h2><p>${item.description}</p>`;
        }

        html += `</div>`;
        html += `<button class="more-btn" id="more-btn">–ï—â—ë</button>`;

        contentDiv.innerHTML = html;

        document.getElementById('more-btn').addEventListener('click', () => {
          showRandomItem(page);
        });
      }
    });
  </script>
</body>
</html>
